Sub 選択範囲の金額を百万円単位にする()
    
    Dim i As Long
    Dim j As Long

    For i = Selection.Row To Selection.Rows(Selection.Rows.Count).Row
        For j = Selection.Column To Selection.Columns(Selection.Columns.Count).Column
            If Cells(i, j).Value <> 0 And Cells(i, j).Value <> "" And _
            TypeName(Cells(i, j).Value) <> "String" And TypeName(Cells(i, j).Value) <> "Date" Then
            'セルの値が0,空白,文字列,日付のいづれかの場合は処理をしない
                Cells(i, j).Value = Application.RoundUp(Cells(i, j).Value / 1000000, 2)    '小数点第三位以下切り上げ
            End If
        Next j
    Next i
    
End Sub
