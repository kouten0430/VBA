Sub 選択範囲に図形を作成する()
    '選択範囲は複数指定可能です
    Dim i As Integer
    Dim x As Long
    Dim y As Long
    Dim xe As Long
    Dim ye As Long
    
    For i = 1 To Selection.Areas.Count
        x = Selection.Areas(i).Left
        y = Selection.Areas(i).Top
        xe = Selection.Areas(i).Width
        ye = Selection.Areas(i).Height
                
        ActiveSheet.Shapes.AddShape msoShapeMoon, x, y, xe, ye  '作成する図形は定数で指定する

    Next i

End Sub