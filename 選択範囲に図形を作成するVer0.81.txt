Sub 選択範囲に図形を作成する()
    '選択範囲は複数指定可能です
    Dim tmp As String
    Dim 図形種類 As Long
    Dim i As Integer
    Dim x As Long
    Dim y As Long
    Dim xe As Long
    Dim ye As Long

    tmp = InputBox("図形を選んで下さい。" & vbCrLf & vbCrLf & _
    "1:正方形／長方形" & vbCrLf & _
    "2:四角形：角を丸くする" & vbCrLf & _
    "3:楕円" & vbCrLf & _
    "4:二等辺三角形" & vbCrLf & _
    "5:直角三角形" & vbCrLf & _
    "6:四角形：メモ" & vbCrLf & _
    "7:左中かっこ" & vbCrLf & _
    "8:右中かっこ" & vbCrLf & _
    "9:矢印：右" & vbCrLf & _
    "10:矢印：左" & vbCrLf & _
    "11:矢印：上" & vbCrLf & _
    "12:矢印：下" & vbCrLf & _
    "13:フローチャート：処理" & vbCrLf & _
    "14:フローチャート：判断" & vbCrLf & _
    "15:吹き出し：四角形" & vbCrLf & _
    "16:吹き出し：角を丸めた四角形" & vbCrLf & _
    "17:吹き出し：円形")
    
    If tmp = "" Then
        Exit Sub
    ElseIf tmp = "1" Then
        図形種類 = msoShapeRectangle
    ElseIf tmp = "2" Then
        図形種類 = msoShapeRoundedRectangle
    ElseIf tmp = "3" Then
        図形種類 = msoShapeOval
    ElseIf tmp = "4" Then
        図形種類 = msoShapeIsoscelesTriangle
    ElseIf tmp = "5" Then
        図形種類 = msoShapeRightTriangle
    ElseIf tmp = "6" Then
        図形種類 = msoShapeFoldedCorner
    ElseIf tmp = "7" Then
        図形種類 = msoShapeLeftBrace
    ElseIf tmp = "8" Then
        図形種類 = msoShapeRightBrace
    ElseIf tmp = "9" Then
        図形種類 = msoShapeRightArrow
    ElseIf tmp = "10" Then
        図形種類 = msoShapeLeftArrow
    ElseIf tmp = "11" Then
        図形種類 = msoShapeUpArrow
    ElseIf tmp = "12" Then
        図形種類 = msoShapeDownArrow
    ElseIf tmp = "13" Then
        図形種類 = msoShapeFlowchartProcess
    ElseIf tmp = "14" Then
        図形種類 = msoShapeFlowchartDecision
    ElseIf tmp = "15" Then
        図形種類 = msoShapeRectangularCallout
    ElseIf tmp = "16" Then
        図形種類 = msoShapeRoundedRectangularCallout
    ElseIf tmp = "17" Then
        図形種類 = msoShapeOvalCallout
    Else
        MsgBox "指定された数字で入力して下さい。"
        Exit Sub
    End If
    
    For i = 1 To Selection.Areas.Count
        x = Selection.Areas(i).Left
        y = Selection.Areas(i).Top
        xe = Selection.Areas(i).Width
        ye = Selection.Areas(i).Height
                
        ActiveSheet.Shapes.AddShape 図形種類, x, y, xe, ye  '作成する図形は定数で指定する

    Next i

End Sub